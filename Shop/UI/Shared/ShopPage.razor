@using Shop.Infrastructure.Http
@using Shop.Utilities
@using Shop.Infrastructure.Common
@using Shop.Infrastructure.Common.Optionals
@using Shop.Infrastructure.Authentication
@inherits ComponentBase

@code {
    [CascadingParameter( Name = "layout" )]
    public MainLayout Layout { get; init; } = default!;
    
    [Inject] protected AuthProvider Auth { get; init; } = default!;
    [Inject] protected IConfiguration Configuration { get; init; } = default!;
    [Inject] protected HttpService Http { get; init; } = default!;
    [Inject] protected NavigationManager Navigation { get; init; } = default!;
    
    protected void GoHome() =>
        Navigate( Urls.PageHome, true );
    protected void Navigate( string page, bool forceReload = false )
    {
        Navigation.NavigateTo( page, forceReload );
    }
    protected void PushSuccess( string message ) => PushAlert( AlertType.Success, message );
    protected void PushWarning( string message ) => PushAlert( AlertType.Warning, message );
    protected void PushError( string message ) => PushAlert( AlertType.Danger, message );
    protected void PushError( IOpt opt, string message ) => PushAlert( AlertType.Danger, $"{message} : {opt.Message()}" );
    protected void PushError( IOpt opt ) => PushAlert( AlertType.Danger, opt.Message() );

    void PushAlert( AlertType type, string message )
    {
        Layout.PushAlert( type, message );
    }
}